#![deny(missing_docs)]
#![doc = include_str!("../README.md")]

#[macro_use]
mod typed_vec;

#[cfg(any(test, feature = "arbitrary"))]
pub mod arbitrary;
pub mod curve;
mod geom;
mod num;
pub mod order;
mod position;
mod segments;
pub mod sweep;
pub mod topology;

#[cfg(feature = "generators")]
pub mod generators;

pub use geom::{Point, Segment};
use kurbo::Shape;
pub use segments::{SegIdx, Segments};

// pub so that we can use it in fuzz tests, but it's really private
#[doc(hidden)]
pub mod treevec;

use topology::{BinaryWindingNumber, Topology};

#[cfg(test)]
pub mod perturbation;

/// A fill rule tells us how to decide whether a point is "inside" a polyline.
#[derive(Clone, Copy, Debug, Eq, PartialEq, Hash)]
pub enum FillRule {
    /// The point is "inside" if its winding number is odd.
    EvenOdd,
    /// The point is "inside" if its winding number is non-zero.
    NonZero,
}

/// Binary operations between sets.
#[derive(Clone, Copy, Debug, Eq, PartialEq, Hash)]
pub enum BinaryOp {
    /// A point is in the union of two sets if it is in either one.
    Union,
    /// A point is in the intersection of two sets if it is in both.
    Intersection,
    /// A point is in the difference of two sets if it is in the first but not the second.
    Difference,
    /// A point is in the exclusive-or of two sets if it is in one or the other, but not both.
    Xor,
}

#[derive(Clone, Copy, Debug, Eq, PartialEq, Hash)]
/// The input points were faulty.
pub enum Error {
    /// At least one of the inputs was infinite.
    Infinity,
    /// At least one of the inputs was not a number.
    NaN,
}

/// Computes a boolean operation between two sets, each of which is described as a collection of closed polylines.
pub fn binary_op(
    set_a: &kurbo::BezPath,
    set_b: &kurbo::BezPath,
    fill_rule: FillRule,
    op: BinaryOp,
) -> Result<topology::Contours, Error> {
    // Find the extremal values, to figure out how much precision we can support.
    let bbox = set_a.bounding_box().union(set_b.bounding_box());
    let min = bbox.min_x().min(bbox.min_y());
    let max = bbox.max_x().max(bbox.max_y());
    if min.is_infinite() || max.is_infinite() {
        return Err(Error::Infinity);
    }
    // If there was any NaN in the input, it should have propagated to the min and max.
    if min.is_nan() || max.is_nan() {
        return Err(Error::NaN);
    }

    // TODO: we did some analysis for error bounds in the case of polylines.
    // Think more about what makes sense for curves.
    let m_2 = min.abs().max(max.abs());
    let eps = m_2 * (f64::EPSILON * 64.0);
    let eps = eps.max(1e-6);

    debug_assert!(eps.is_finite());

    let top = Topology::from_paths_binary(set_a, set_b, eps);

    let inside = |windings: BinaryWindingNumber| {
        let inside_one = |winding| match fill_rule {
            FillRule::EvenOdd => winding % 2 != 0,
            FillRule::NonZero => winding != 0,
        };

        match op {
            BinaryOp::Union => inside_one(windings.shape_a) || inside_one(windings.shape_b),
            BinaryOp::Intersection => inside_one(windings.shape_a) && inside_one(windings.shape_b),
            BinaryOp::Xor => inside_one(windings.shape_a) != inside_one(windings.shape_b),
            BinaryOp::Difference => inside_one(windings.shape_a) && !inside_one(windings.shape_b),
        }
    };

    Ok(top.contours(inside))
}

#[cfg(test)]
mod tests {
    use kurbo::BezPath;

    use super::*;

    #[test]
    fn two_squares() {
        fn to_bez(mut points: impl Iterator<Item = (f64, f64)>) -> BezPath {
            let p = points.next().unwrap();
            let mut ret = BezPath::default();
            ret.move_to(p);
            for q in points {
                ret.line_to(q);
            }
            ret.line_to(p);
            ret
        }
        let a = vec![(0.0, 0.0), (1.0, 0.0), (1.0, 1.0), (0.0, 1.0)];
        let b = vec![(-0.5, -0.5), (0.5, -0.5), (0.5, 0.5), (-0.5, 0.5)];
        let output = binary_op(
            &to_bez(a.into_iter()),
            &to_bez(b.into_iter()),
            FillRule::EvenOdd,
            BinaryOp::Intersection,
        )
        .unwrap();

        insta::assert_ron_snapshot!(output);
    }

    // This example came from fiddling with graphite, caused by the positioning not making progress.
    #[test]
    fn graphite_hang() {
        let p1 = BezPath::from_svg("M27.30779709,-257.85907878 C27.30779665,-257.85907835 27.307796200000002,-257.85907792 27.30779576,-257.8590775 C27.292172620000002,-257.8439677 -109.98458240000001,-125.07781586 -233.88593633,-5.24757973 C-233.88593684,-5.24757923 -233.88593736,-5.24757873 -233.88593787,-5.24757824 C-233.88593736,-5.2475777400000005 -233.88593684,-5.24757724 -233.88593632,-5.24757675 C-174.52579263,51.894883570000005 -115.13821436,109.22164426 -77.72402204000001,145.36173051 C-77.72402157,145.36173091 -77.72402116,145.3617313 -77.7240208,145.3617317 C-77.7240208,145.3617317 -77.72402077,145.3617317 -77.72402077,145.3617317 C-77.72401908,145.3617313 -77.72401740000001,145.36173091 -77.72401572,145.36173051 C-1.60745976,127.42335802000001 72.89114167,108.36966443 101.12619937000001,101.0791851 C101.12620127,101.07918461 101.12620318,101.07918412000001 101.12620509,101.07918362000001 C101.1262059,101.07918313 101.12620674,101.07918264 101.1262076,101.07918215000001 C105.56968257,98.47134695 110.06808693,95.83127419 114.61338829,93.16367801 C114.61338927,93.16367744 114.61339025000001,93.16367686 114.61339123,93.16367628 C114.61339123,93.16367628 114.61339123,93.16367628 114.61339123,93.16367628 C114.61339142,93.16367571 114.61339161000001,93.16367513 114.6133918,93.16367456 C123.52785808,66.12754849 166.90764887,-69.59356743000001 182.19132273,-195.37502561 C182.19132278,-195.37502607 182.19132284,-195.37502653 182.19132290000002,-195.37502699 C182.19132175000001,-195.37502746 182.19132061,-195.37502792 182.19131946000002,-195.37502838 C99.03601942,-228.9220441 27.32536748,-257.85199043 27.307800320000002,-257.8590775 C27.30779923,-257.85907792 27.30779816,-257.85907835 27.30779709,-257.85907878 L27.30779709,-257.85907878 Z M-408.62463824,-172.46325538 C-408.62463827,-172.46325472 -408.62463831,-172.46325406 -408.62463834,-172.4632534 C-414.02520486000003,-63.40231834 -377.28160484,34.20037327 -342.02221595000003,99.33558422 C-342.02221565,99.33558477 -342.02221536,99.33558531 -342.02221506,99.33558586000001 C-342.02221506,99.33558586000001 -342.02221506,99.33558586000001 -342.02221506,99.33558586000001 C-342.0222145,99.33558531 -342.02221393,99.33558477 -342.02221337000003,99.33558422 C-310.40978596,68.76186957 -272.80781456,32.395413760000004 -233.88593941,-5.24757675 C-233.8859389,-5.24757724 -233.88593838,-5.2475777400000005 -233.88593787,-5.24757824 C-233.88593787,-5.24757824 -233.88593787,-5.24757824 -233.88593787,-5.24757824 C-233.88593839,-5.24757873 -233.88593891,-5.24757923 -233.88593942,-5.24757973 C-304.53464918000003,-73.25686748 -375.14449713,-141.00509201 -408.62463617000003,-172.4632534 C-408.62463687,-172.46325406 -408.62463756,-172.46325472 -408.62463824,-172.46325538 L-408.62463824,-172.46325538 Z").unwrap();
        let p2 = BezPath::from_svg("M27.3077958,-257.85907753 C27.2923816,-257.84416980000003 -109.98448809,-125.07790706 -233.88593634,-5.24757971 C-233.88593634,-5.24757971 -233.88593825,-5.24757971 -233.88593825,-5.24757971 C-233.88593941,-5.24757971 -233.88593942,-5.24757972 -233.88593942,-5.24757972 C-304.53459173,-73.25681217 -375.1443823,-141.00498183 -408.62463995,-172.46317667 C-408.62464066,-172.46317733 -408.62464135,-172.46317798 -408.62464203,-172.46317863000002 C-408.62464208,-172.46317798 -408.62464211,-172.46317733 -408.62464214,-172.46317667 C-414.02518763,-63.40227258 -377.28159657000003,34.20038853 -342.02221596,99.3355842 C-342.02221566000003,99.33558476 -342.02221536,99.33558531 -342.02221506,99.33558586000001 C-342.02221449,99.33558531 -342.02221392,99.33558476 -342.02221335,99.3355842 C-310.40978594,68.76186955 -272.80781455,32.39541375 -233.88593941,-5.24757675 C-233.88593941,-5.24757675 -233.88593941,-5.24757675 -233.88593941,-5.24757675 C-233.88593889,-5.24757724 -233.88593838,-5.2475777400000005 -233.88593787,-5.24757823 C-233.88593735,-5.2475777400000005 -233.88593684,-5.24757724 -233.88593632,-5.24757675 C-233.88593632,-5.24757675 -233.88593632,-5.24757675 -233.88593632,-5.24757675 C-174.52579259,51.89488361 -115.13821427,109.22164435 -77.72402196,145.36173056 C-77.72402157,145.36173094 -77.72402117,145.36173132 -77.72402078,145.3617317 C-77.72401917,145.36173132 -77.72401755,145.36173094 -77.72401594,145.36173056 C-1.60745982,127.42335803 72.89114182,108.36966439 101.12619946,101.07918507000001 C101.12620136,101.07918458 101.12620325,101.07918409 101.12620514,101.07918360000001 C101.12620595,101.07918311 101.12620679,101.07918263 101.12620764,101.07918214 C105.56968257,98.47134695 110.0680869,95.83127422 114.61338822,93.16367806 C114.61338923,93.16367747 114.61339023000001,93.16367689 114.61339123,93.1636763 C114.61339142,93.16367571 114.61339161000001,93.16367512000001 114.61339181,93.16367453000001 C123.52785811,66.12754843 166.90764887,-69.59356747 182.19132273,-195.37502563 C182.19132279000002,-195.37502608 182.19132285,-195.37502654 182.19132289,-195.37502699 C182.19132177,-195.37502745 182.19132064000001,-195.3750279 182.1913195,-195.37502836000002 C99.03588674,-228.92209763 27.32513858,-257.85208278 27.30780024,-257.85907753 C27.30780024,-257.85907753 27.30779791,-257.85907753 27.30779791,-257.85907753 C27.30779791,-257.85907753 27.3077958,-257.85907753 27.3077958,-257.85907753 L27.3077958,-257.85907753 Z").unwrap();
        binary_op(&p1, &p2, FillRule::EvenOdd, BinaryOp::Union).unwrap();
    }

    #[test]
    fn graphite_crash() {
        let p1 = BezPath::from_svg("M-51,-390 C-51.00000037,-389.99999955 -51.00000075,-389.99999909 -51.00000112,-389.99999864 C-51.0133208,-389.98380542 -169.63665568,-245.76914195 -276.70205531,-115.60587692 C-276.70205486000003,-115.60587746 -276.70205486000003,-115.60587746 -276.70205531,-115.60587692 C-276.70205486000003,-115.60587638 -276.70205442,-115.60587585 -276.70205397,-115.60587531 C-192.38931516,-13.58098944 -108.0125259,88.98477391 -108.00000139000001,88.99999842 C-108.00000091,88.99999895 -108.00000044000001,88.99999947 -108,89 C-107.99999928,88.99999947 -107.99999924000001,88.99999947 -107.9999999,89 C-107.99266176,88.99458625 300,-212 300,-212 C300,-212 -50.96433872,-389.98191536 -50.99999728,-389.99999864 C-50.9999982,-389.99999909 -50.999999100000004,-389.99999955 -51,-390 L-51,-390 Z M-445,-317 C-445.000001,-316.99999994 -445.00000199,-316.99999988 -445.00000299,-316.99999981 C-445.00000199,-316.99999976 -445.00000193,-316.99999971 -445.0000028,-316.99999965 C-445.00000193,-316.9999996 -445.00000188,-316.99999956 -445.00000264,-316.99999951 C-445.00000188,-316.99999943 -445.00000216,-316.99999934 -445.0000035,-316.99999926 C-445.00000216,-316.9999992 -445.000002,-316.99999914 -445.000003,-316.99999907 C-445.000002,-316.99999903 -445.00000187,-316.99999898 -445.00000262000003,-316.99999893 C-445.00000187,-316.99999886 -445.00000206,-316.99999879 -445.00000319000003,-316.99999872 C-445.00000206,-316.99999865 -445.00000206,-316.99999858 -445.00000319000003,-316.99999851 C-445.07164839,-316.99554979 -606,-307 -606,-307 C-606,-307 -445.00289573000003,88.99287759 -445,89 C-445.00000023,88.99999940000001 -445.00000023,88.99999940000001 -445,89 C-444.99999951,88.99999940000001 -444.99999901,88.9999988 -444.99999852,88.99999820000001 C-444.98741208,88.98469641 -364.75335505,-8.5587384 -276.70205664,-115.60587531 C-276.70205619,-115.60587585 -276.70205575,-115.60587638 -276.70205531,-115.60587692 C-276.70205531,-115.60587692 -276.70205531,-115.60587692 -276.70205531,-115.60587692 C-276.70205576,-115.60587746 -276.7020562,-115.605878 -276.70205665000003,-115.60587854 C-360.13048219,-216.56067745000001 -443.49619297,-316.98588429 -444.99987267,-316.99999851 C-444.99987444,-316.99999858 -444.99987444,-316.99999865 -444.99987267,-316.99999872 C-444.99987444,-316.99999879 -444.99987601000004,-316.99999886 -444.99987738,-316.99999893 C-444.99988877,-316.99999898 -444.99988744,-316.99999903 -444.99987339,-316.99999907 C-444.9998795,-316.99999914 -444.99987949,-316.9999992 -444.99987336,-316.99999926 C-444.99986538,-316.99999934 -444.99986663,-316.99999943 -444.99987712,-316.99999951 C-444.99988835,-316.99999956 -444.99988766,-316.9999996 -444.99987503,-316.99999965 C-444.99988443,-316.99999971 -444.9998839,-316.99999976 -444.99987344,-316.99999981 C-444.99987969,-316.99999988 -444.99992188,-316.99999994 -445,-317 L-445,-317 Z").unwrap();
        let p2 = BezPath::from_svg("M-147.77035068,-523.63725234 C-147.77897268,-523.63725228 -147.78328911,-523.63725221 -147.78329996,-523.63725215 C-147.78278455,-523.6372520900001 -147.78276705,-523.63725204 -147.78324747,-523.63725198 C-147.78238075000002,-523.63725194 -147.78233785,-523.63725189 -147.78311876,-523.63725184 C-147.78494057,-523.63725176 -147.78487849,-523.63725167 -147.78293254,-523.63725159 C-147.78318771,-523.6372515200001 -147.78331018,-523.63725146 -147.78329996,-523.6372514 C-147.78235912,-523.63725135 -147.78229246,-523.6372513 -147.78309999,-523.63725125 C-147.78382096,-523.63725118 -147.78386999,-523.63725111 -147.78324709,-523.63725104 C-147.78386999,-523.63725097 -147.78386999,-523.6372509 -147.78324709,-523.63725083 C-290.97059178,-523.62540865 -459.36114997,-454.02730629 -459.36114997,-454.02730629 C-503.78067701000003,-360.84914474 -515.91201353,-267.22250217 -511.28673862,-182.54906502 C-501.51553210000003,-3.67069389 -416.96053353,135.25003698 -404.05763535,145.57150696 C-402.79147715,146.58435025 -400.17221075000003,147.05752789000002 -396.38569434,147.05843347 C-396.38546768000003,147.05843352 -396.3852332,147.05843358 -396.3849909,147.05843363 C-396.38523229000003,147.05843368 -396.3852474,147.05843373 -396.38503624000003,147.05843377 C-396.38525358,147.05843386 -396.38517355,147.05843394000001 -396.38479617,147.05843402 C-396.38516954,147.05843409 -396.38521642,147.05843415 -396.38493682,147.05843421 C-396.38521417,147.05843426 -396.38524896,147.05843430000002 -396.38504119,147.05843435 C-396.38525258,147.05843442 -396.38520028,147.05843449 -396.38488428,147.05843456 C-396.38520028,147.05843463 -396.38183866,147.0584347 -396.37479941,147.05843477 C-396.36776496,147.0584347 -396.36439327,147.05843463 -396.36468434,147.05843456 C-396.36439327,147.05843449 -396.36434448,147.05843442 -396.36453799000003,147.05843435 C-396.36434177,147.05843430000002 -396.36437435,147.05843426 -396.36463574,147.05843421 C-396.36437604,147.05843415 -396.36441911000003,147.05843409 -396.36476495,147.05843402 C-396.36442211,147.05843394000001 -396.36434802,147.05843386 -396.36454266,147.05843377 C-396.36434339,147.05843373 -396.36435761,147.05843368 -396.36458529000004,147.05843363 C-396.36435829,147.05843358 -396.36412543,147.05843352 -396.36388671000003,147.05843347 C-343.24271064,147.0457326 -61.00302123,54.328209290000004 -61.00302123,54.328209290000004 C-61.00302123,54.328209290000004 54.36842292,-476.62945279 -57.54655157,-511.5974822 C-84.89366723,-520.14213629 -115.68055714,-523.63459936 -147.75748146,-523.63725083 C-147.75684889000001,-523.6372509 -147.75684889000001,-523.63725097 -147.75748146,-523.63725104 C-147.75684889000001,-523.63725111 -147.75689632,-523.63725118 -147.75762373,-523.63725125 C-147.75842483,-523.6372513 -147.75835924,-523.63725135 -147.75742698,-523.6372514 C-147.75740817,-523.63725146 -147.75753208,-523.6372515200001 -147.7577987,-523.63725159 C-147.75584128,-523.63725167 -147.75577675,-523.63725176 -147.75760512,-523.63725184 C-147.75837949,-523.63725189 -147.75833706,-523.63725194 -147.75747781,-523.63725198 C-147.75795075,-523.63725204 -147.75793379,-523.6372520900001 -147.75742692,-523.63725215 C-147.75742922,-523.63725221 -147.76173714,-523.63725228 -147.77035068,-523.63725234 L-147.77035068,-523.63725234 Z").unwrap();
        binary_op(&p1, &p2, FillRule::EvenOdd, BinaryOp::Intersection).unwrap();
    }

    #[test]
    fn graphite_crash_2() {
        let p1 = BezPath::from_svg("M-4.04445106,-227.53699448 C-4.04445141,-227.53699414000002 -4.04445176,-227.5369938 -4.0444521,-227.53699347 C-51.7088457,-181.43874387 -146.15069456,-90.10004021 -233.88593633,-5.24757973 C-233.88593684,-5.24757923 -233.88593736,-5.24757873 -233.88593787,-5.24757824 C-233.88593736,-5.2475777400000005 -233.88593684,-5.24757724 -233.88593632,-5.24757675 C-136.31505417,88.6780763 -38.67004972,183.1016691 -38.655462480000004,183.1157752 C-38.65546192,183.11577569 -38.65546137,183.11577618 -38.655460850000004,183.11577667 C-38.65546,183.11577618 -38.655459130000004,183.11577569 -38.65545825,183.1157752 C-38.636636960000004,183.10472910000001 63.43909693,123.19740587 172.66309485,59.09483126 C172.66309582,59.0948307 172.66309679,59.09483013 172.66309776,59.09482957 C172.66309789000002,59.094829000000004 172.66309804,59.09482844 172.66309821000002,59.09482787 C195.93027539,-28.361478 218.13974889,-146.00472757 185.99061181,-193.84229367 C185.99061146,-193.84229419000002 185.99061111,-193.84229471 185.99061077000002,-193.84229523 C185.99061077000002,-193.84229523 185.99061076,-193.84229523 185.99061076,-193.84229523 C185.99060948000002,-193.84229575 185.99060819000002,-193.84229627 185.99060690000002,-193.84229679 C163.21411887,-203.03092579 141.22123575,-211.90342815 121.23520424,-219.96631425 C121.23520325,-219.96631465000002 121.23520226000001,-219.96631505 121.23520127,-219.96631545 C121.23519826,-219.96631585 121.23519525,-219.96631625 121.23519224,-219.96631665 C81.94489447000001,-225.17543523 38.58618673,-227.27591237000001 -4.04428678,-227.53699347 C-4.0443415400000005,-227.5369938 -4.0443963,-227.53699414000002 -4.04445106,-227.53699448 L-4.04445106,-227.53699448 Z M-298.96972663,-67.82445804 C-298.96972679,-67.82445746 -298.96972695,-67.82445687 -298.96972711,-67.82445628 C-308.0266757,-34.79351542 -313.47490909,-4.88751908 -311.92312795,13.14190599 C-310.47587425,29.956875240000002 -307.39575194,46.21813067 -303.15410566,61.74459228 C-303.1541055,61.74459287 -303.15410534,61.74459345 -303.15410518,61.74459404 C-303.15410518,61.74459404 -303.15410509000003,61.74459404 -303.15410509000003,61.74459404 C-303.1541046,61.74459345 -303.15410399,61.74459287 -303.15410327,61.74459228 C-281.29005965,40.5989515 -257.83792341000003,17.91739932 -233.88593941,-5.24757675 C-233.8859389,-5.24757724 -233.88593838,-5.2475777400000005 -233.88593787,-5.24757824 C-233.88593787,-5.24757824 -233.88593787,-5.24757824 -233.88593787,-5.24757824 C-233.88593839,-5.24757873 -233.88593891,-5.24757923 -233.88593942,-5.24757973 C-255.96152711,-26.49842777 -278.03332044,-47.72378629 -298.96972479,-67.82445628 C-298.96972541,-67.82445687 -298.96972602,-67.82445746 -298.96972663,-67.82445804 L-298.96972663,-67.82445804 Z").unwrap();
        let p2 = BezPath::from_svg("M-4.04445105,-227.53699448 C-4.0444448,-227.53699444 -4.04443853,-227.5369944 -4.04443224,-227.53699436 C-4.04443855,-227.53699429 -4.04443619,-227.53699422 -4.04442515,-227.53699416 C-4.04443617,-227.53699411 -4.0444375500000005,-227.53699405 -4.04442929,-227.536994 C-4.04443757,-227.53699393 -4.0444355100000005,-227.53699385000002 -4.0444230800000005,-227.53699378000002 C-4.0444355100000005,-227.5369937 -4.04444445,-227.53699362 -4.0444499,-227.53699355 C-4.04444445,-227.53699362 -4.0444355100000005,-227.5369937 -4.0444230800000005,-227.53699378000002 C-4.0444355100000005,-227.53699385000002 -4.04443757,-227.53699393 -4.04442929,-227.536994 C-4.0444375500000005,-227.53699405 -4.04443617,-227.53699411 -4.04442515,-227.53699416 C-4.04443619,-227.53699422 -4.04443855,-227.53699429 -4.04443224,-227.53699436 C-4.04443853,-227.5369944 -4.0444448,-227.53699444 -4.04445105,-227.53699448 L-4.04445105,-227.53699448 Z M-4.04445201,-227.53699355 C-51.70884559,-181.43874397 -146.15069452,-90.10004025 -233.88593634,-5.24757971 C-233.88593634,-5.24757971 -233.88593825,-5.24757971 -233.88593825,-5.24757971 C-233.88593941,-5.24757971 -233.88593942,-5.24757972 -233.88593942,-5.24757972 C-255.96152637,-26.49842706 -278.03331896000003,-47.72378487 -298.9697253,-67.82445426 C-298.96972593,-67.82445486 -298.96972655,-67.82445546 -298.96972717,-67.82445606 C-298.96972733,-67.82445546 -298.96972750000003,-67.82445486 -298.96972767,-67.82445426 C-308.02667592,-34.793514200000004 -313.47490906,-4.88751871 -311.92312795,13.14190599 C-310.47587426,29.95687522 -307.39575195000003,46.21813063 -303.15410568,61.74459222 C-303.15410552000003,61.74459282 -303.15410535,61.74459342 -303.15410519,61.74459402 C-303.15410457,61.74459342 -303.15410394,61.74459282 -303.15410332,61.74459222 C-281.29005969,40.59895153 -257.83792342,17.917399330000002 -233.88593941,-5.24757675 C-233.88593941,-5.24757675 -233.88593941,-5.24757675 -233.88593941,-5.24757675 C-233.88593889,-5.24757724 -233.88593838,-5.2475777400000005 -233.88593787,-5.24757823 C-233.88593735,-5.2475777400000005 -233.88593684,-5.24757724 -233.88593632,-5.24757675 C-233.88593632,-5.24757675 -233.88593632,-5.24757675 -233.88593632,-5.24757675 C-136.31500758,88.67812116 -38.66995645,183.1017593 -38.65546246,183.11577522000002 C-38.6554624,183.11577526 -38.65546235,183.11577531 -38.6554623,183.11577536000001 C-38.65546195,183.11577567 -38.65546121,183.11577599 -38.6554601,183.1157763 C-38.65545957,183.11577599 -38.65545901,183.11577567 -38.6554584,183.11577536000001 C-38.63718132,183.10504862 63.43880567,123.19757684 172.6630948,59.094831310000004 C172.66309578,59.09483074 172.66309677,59.09483016 172.66309775,59.09482959 C172.66309789000002,59.09482901 172.66309804,59.09482844 172.66309821000002,59.09482786 C195.93027539,-28.36147801 218.13974889,-146.00472758 185.99061181,-193.84229367 C185.99061146,-193.84229419000002 185.9906111,-193.84229471 185.99061076,-193.84229523 C185.99060946,-193.84229576 185.99060816,-193.84229627 185.99060688,-193.8422968 C163.21411883,-203.03092581 141.22123568,-211.90342818 121.23520415,-219.96631429 C121.2352032,-219.96631467 121.23520226000001,-219.96631506 121.23520131000001,-219.96631544000002 C121.23519842,-219.96631582 121.23519553,-219.96631621 121.23519264000001,-219.96631659 C81.94489083,-225.17543574 38.5861782,-227.27591278 -4.04429958,-227.53699355 C-4.04429958,-227.53699355 -4.0444499,-227.53699355 -4.0444499,-227.53699355 C-4.0444499,-227.53699355 -4.04445201,-227.53699355 -4.04445201,-227.53699355 L-4.04445201,-227.53699355 Z").unwrap();
        binary_op(&p1, &p2, FillRule::EvenOdd, BinaryOp::Union).unwrap();
    }

    #[test]
    fn graphite_crash_3() {
        let p1 = BezPath::from_svg("M989.66666667,768 C1058.74723866,687.80584194 1094.1623535200001,594.2965698200001 1094.1623535200001,594.2965698200001 C1173.36305304,625.10359457 1293.66666667,681 1318,768 L1299.30645729,786.39937432 L1011.11108398,786.39935303 L989.66666667,768 L989.66666667,768").unwrap();
        let p2 = BezPath::from_svg("M997.50296389,540.72139231 C1000.26188778,540.72139231 1002.50296389,542.96246842 1002.50296389,545.72139231 C1002.50296389,548.4803162000001 1000.26188778,550.72139231 997.50296389,550.72139231 C994.74404,550.72139231 992.50296389,548.4803162000001 992.50296389,545.72139231 C992.50296389,542.96246842 994.74404,540.72139231 997.50296389,540.72139231 L997.50296389,540.72139231 M1024.77569116,545.26684685 C1027.53461505,545.26684685 1029.77569116,547.50792297 1029.77569116,550.26684685 C1029.77569116,553.02577074 1027.53461505,555.26684685 1024.77569116,555.26684685 C1022.0167672700001,555.26684685 1019.7756911600001,553.02577074 1019.7756911600001,550.26684685 C1019.7756911600001,547.50792297 1022.0167672700001,545.26684685 1024.77569116,545.26684685 L1024.77569116,545.26684685 M1052.04841843,549.8123014 C1054.80734232,549.8123014 1057.04841843,552.05337751 1057.04841843,554.8123014 C1057.04841843,557.57122529 1054.80734232,559.8123014 1052.04841843,559.8123014 C1049.28949454,559.8123014 1047.04841843,557.57122529 1047.04841843,554.8123014 C1047.04841843,552.05337751 1049.28949454,549.8123014 1052.04841843,549.8123014 L1052.04841843,549.8123014 M1079.32114571,554.35775595 C1082.08006959,554.35775595 1084.32114571,556.5988320600001 1084.32114571,559.35775595 C1084.32114571,562.1166798300001 1082.08006959,564.35775595 1079.32114571,564.35775595 C1076.56222182,564.35775595 1074.32114571,562.1166798300001 1074.32114571,559.35775595 C1074.32114571,556.5988320600001 1076.56222182,554.35775595 1079.32114571,554.35775595 L1079.32114571,554.35775595 M1106.59387298,558.90321049 C1109.35279687,558.90321049 1111.59387298,561.1442866 1111.59387298,563.90321049 C1111.59387298,566.66213438 1109.35279687,568.90321049 1106.59387298,568.90321049 C1103.83494909,568.90321049 1101.59387298,566.66213438 1101.59387298,563.90321049 C1101.59387298,561.1442866 1103.83494909,558.90321049 1106.59387298,558.90321049 L1106.59387298,558.90321049 M1133.86660025,563.44866504 C1136.62552414,563.44866504 1138.86660025,565.68974115 1138.86660025,568.44866504 C1138.86660025,571.20758893 1136.62552414,573.44866504 1133.86660025,573.44866504 C1131.10767636,573.44866504 1128.86660025,571.20758893 1128.86660025,568.44866504 C1128.86660025,565.68974115 1131.10767636,563.44866504 1133.86660025,563.44866504 L1133.86660025,563.44866504 M1161.13932752,567.99411958 C1163.89825141,567.99411958 1166.13932752,570.2351956900001 1166.13932752,572.99411958 C1166.13932752,575.75304347 1163.89825141,577.99411958 1161.13932752,577.99411958 C1158.38040363,577.99411958 1156.13932752,575.75304347 1156.13932752,572.99411958 C1156.13932752,570.2351956900001 1158.38040363,567.99411958 1161.13932752,567.99411958 L1161.13932752,567.99411958 M1188.4120548,572.53957413 C1191.17097868,572.53957413 1193.4120548,574.78065024 1193.4120548,577.53957413 C1193.4120548,580.29849802 1191.17097868,582.53957413 1188.4120548,582.53957413 C1185.65313091,582.53957413 1183.4120548,580.29849802 1183.4120548,577.53957413 C1183.4120548,574.78065024 1185.65313091,572.53957413 1188.4120548,572.53957413 L1188.4120548,572.53957413 M1215.68478207,577.08502867 C1218.44370596,577.08502867 1220.68478207,579.32610478 1220.68478207,582.08502867 C1220.68478207,584.84395256 1218.44370596,587.08502867 1215.68478207,587.08502867 C1212.92585818,587.08502867 1210.68478207,584.84395256 1210.68478207,582.08502867 C1210.68478207,579.32610478 1212.92585818,577.08502867 1215.68478207,577.08502867 L1215.68478207,577.08502867 M1242.9575093400001,581.63048322 C1245.7164332300001,581.63048322 1247.9575093400001,583.87155933 1247.9575093400001,586.63048322 C1247.9575093400001,589.38940711 1245.7164332300001,591.63048322 1242.9575093400001,591.63048322 C1240.19858545,591.63048322 1237.9575093400001,589.38940711 1237.9575093400001,586.63048322 C1237.9575093400001,583.87155933 1240.19858545,581.63048322 1242.9575093400001,581.63048322 L1242.9575093400001,581.63048322 M1270.23023661,586.17593776 C1272.9891605,586.17593776 1275.23023661,588.41701387 1275.23023661,591.17593776 C1275.23023661,593.93486165 1272.9891605,596.17593776 1270.23023661,596.17593776 C1267.4713127300001,596.17593776 1265.23023661,593.93486165 1265.23023661,591.17593776 C1265.23023661,588.41701387 1267.4713127300001,586.17593776 1270.23023661,586.17593776 L1270.23023661,586.17593776 M1297.50296389,590.72139231 C1300.26188778,590.72139231 1302.50296389,592.96246842 1302.50296389,595.72139231 C1302.50296389,598.4803162000001 1300.26188778,600.72139231 1297.50296389,600.72139231 C1294.74404,600.72139231 1292.50296389,598.4803162000001 1292.50296389,595.72139231 C1292.50296389,592.96246842 1294.74404,590.72139231 1297.50296389,590.72139231 L1297.50296389,590.72139231 M997.50296389,569.29282088 C1000.26188778,569.29282088 1002.50296389,571.53389699 1002.50296389,574.29282088 C1002.50296389,577.05174477 1000.26188778,579.29282088 997.50296389,579.29282088 C994.74404,579.29282088 992.50296389,577.05174477 992.50296389,574.29282088 C992.50296389,571.53389699 994.74404,569.29282088 997.50296389,569.29282088 L997.50296389,569.29282088 M1024.77569116,573.8382754300001 C1027.53461505,573.8382754300001 1029.77569116,576.0793515400001 1029.77569116,578.8382754300001 C1029.77569116,581.5971993100001 1027.53461505,583.8382754300001 1024.77569116,583.8382754300001 C1022.0167672700001,583.8382754300001 1019.7756911600001,581.5971993100001 1019.7756911600001,578.8382754300001 C1019.7756911600001,576.0793515400001 1022.0167672700001,573.8382754300001 1024.77569116,573.8382754300001 L1024.77569116,573.8382754300001 M1052.04841843,578.38372997 C1054.80734232,578.38372997 1057.04841843,580.62480608 1057.04841843,583.38372997 C1057.04841843,586.14265386 1054.80734232,588.38372997 1052.04841843,588.38372997 C1049.28949454,588.38372997 1047.04841843,586.14265386 1047.04841843,583.38372997 C1047.04841843,580.62480608 1049.28949454,578.38372997 1052.04841843,578.38372997 L1052.04841843,578.38372997 M1079.32114571,582.92918452 C1082.08006959,582.92918452 1084.32114571,585.17026063 1084.32114571,587.92918452 C1084.32114571,590.68810841 1082.08006959,592.92918452 1079.32114571,592.92918452 C1076.56222182,592.92918452 1074.32114571,590.68810841 1074.32114571,587.92918452 C1074.32114571,585.17026063 1076.56222182,582.92918452 1079.32114571,582.92918452 L1079.32114571,582.92918452 M1106.59387298,587.47463906 C1109.35279687,587.47463906 1111.59387298,589.7157151700001 1111.59387298,592.47463906 C1111.59387298,595.23356295 1109.35279687,597.47463906 1106.59387298,597.47463906 C1103.83494909,597.47463906 1101.59387298,595.23356295 1101.59387298,592.47463906 C1101.59387298,589.7157151700001 1103.83494909,587.47463906 1106.59387298,587.47463906 L1106.59387298,587.47463906 M1133.86660025,592.02009361 C1136.62552414,592.02009361 1138.86660025,594.26116972 1138.86660025,597.02009361 C1138.86660025,599.7790175 1136.62552414,602.02009361 1133.86660025,602.02009361 C1131.10767636,602.02009361 1128.86660025,599.7790175 1128.86660025,597.02009361 C1128.86660025,594.26116972 1131.10767636,592.02009361 1133.86660025,592.02009361 L1133.86660025,592.02009361 M1161.13932752,596.56554815 C1163.89825141,596.56554815 1166.13932752,598.80662426 1166.13932752,601.56554815 C1166.13932752,604.32447204 1163.89825141,606.56554815 1161.13932752,606.56554815 C1158.38040363,606.56554815 1156.13932752,604.32447204 1156.13932752,601.56554815 C1156.13932752,598.80662426 1158.38040363,596.56554815 1161.13932752,596.56554815 L1161.13932752,596.56554815 M1188.4120548,601.1110027 C1191.17097868,601.1110027 1193.4120548,603.35207881 1193.4120548,606.1110027 C1193.4120548,608.86992659 1191.17097868,611.1110027 1188.4120548,611.1110027 C1185.65313091,611.1110027 1183.4120548,608.86992659 1183.4120548,606.1110027 C1183.4120548,603.35207881 1185.65313091,601.1110027 1188.4120548,601.1110027 L1188.4120548,601.1110027 M1215.68478207,605.65645724 C1218.44370596,605.65645724 1220.68478207,607.89753336 1220.68478207,610.65645724 C1220.68478207,613.41538113 1218.44370596,615.65645724 1215.68478207,615.65645724 C1212.92585818,615.65645724 1210.68478207,613.41538113 1210.68478207,610.65645724 C1210.68478207,607.89753336 1212.92585818,605.65645724 1215.68478207,605.65645724 L1215.68478207,605.65645724 M1242.9575093400001,610.20191179 C1245.7164332300001,610.20191179 1247.9575093400001,612.4429879 1247.9575093400001,615.20191179 C1247.9575093400001,617.9608356800001 1245.7164332300001,620.20191179 1242.9575093400001,620.20191179 C1240.19858545,620.20191179 1237.9575093400001,617.9608356800001 1237.9575093400001,615.20191179 C1237.9575093400001,612.4429879 1240.19858545,610.20191179 1242.9575093400001,610.20191179 L1242.9575093400001,610.20191179 M1270.23023661,614.74736634 C1272.9891605,614.74736634 1275.23023661,616.98844245 1275.23023661,619.74736634 C1275.23023661,622.50629022 1272.9891605,624.74736634 1270.23023661,624.74736634 C1267.4713127300001,624.74736634 1265.23023661,622.50629022 1265.23023661,619.74736634 C1265.23023661,616.98844245 1267.4713127300001,614.74736634 1270.23023661,614.74736634 L1270.23023661,614.74736634 M1297.50296389,619.29282088 C1300.26188778,619.29282088 1302.50296389,621.53389699 1302.50296389,624.29282088 C1302.50296389,627.05174477 1300.26188778,629.29282088 1297.50296389,629.29282088 C1294.74404,629.29282088 1292.50296389,627.05174477 1292.50296389,624.29282088 C1292.50296389,621.53389699 1294.74404,619.29282088 1297.50296389,619.29282088 L1297.50296389,619.29282088 M997.50296389,597.86424945 C1000.26188778,597.86424945 1002.50296389,600.10532556 1002.50296389,602.86424945 C1002.50296389,605.62317334 1000.26188778,607.86424945 997.50296389,607.86424945 C994.74404,607.86424945 992.50296389,605.62317334 992.50296389,602.86424945 C992.50296389,600.10532556 994.74404,597.86424945 997.50296389,597.86424945 L997.50296389,597.86424945 M1024.77569116,602.409704 C1027.53461505,602.409704 1029.77569116,604.65078011 1029.77569116,607.409704 C1029.77569116,610.16862789 1027.53461505,612.409704 1024.77569116,612.409704 C1022.0167672700001,612.409704 1019.7756911600001,610.16862789 1019.7756911600001,607.409704 C1019.7756911600001,604.65078011 1022.0167672700001,602.409704 1024.77569116,602.409704 L1024.77569116,602.409704 M1052.04841843,606.95515854 C1054.80734232,606.95515854 1057.04841843,609.1962346500001 1057.04841843,611.95515854 C1057.04841843,614.71408243 1054.80734232,616.95515854 1052.04841843,616.95515854 C1049.28949454,616.95515854 1047.04841843,614.71408243 1047.04841843,611.95515854 C1047.04841843,609.1962346500001 1049.28949454,606.95515854 1052.04841843,606.95515854 L1052.04841843,606.95515854 M1079.32114571,611.50061309 C1082.08006959,611.50061309 1084.32114571,613.7416892 1084.32114571,616.50061309 C1084.32114571,619.25953698 1082.08006959,621.50061309 1079.32114571,621.50061309 C1076.56222182,621.50061309 1074.32114571,619.25953698 1074.32114571,616.50061309 C1074.32114571,613.7416892 1076.56222182,611.50061309 1079.32114571,611.50061309 L1079.32114571,611.50061309 M1106.59387298,616.04606763 C1109.35279687,616.04606763 1111.59387298,618.28714374 1111.59387298,621.04606763 C1111.59387298,623.80499152 1109.35279687,626.04606763 1106.59387298,626.04606763 C1103.83494909,626.04606763 1101.59387298,623.80499152 1101.59387298,621.04606763 C1101.59387298,618.28714374 1103.83494909,616.04606763 1106.59387298,616.04606763 L1106.59387298,616.04606763 M1133.86660025,620.59152218 C1136.62552414,620.59152218 1138.86660025,622.83259829 1138.86660025,625.59152218 C1138.86660025,628.35044607 1136.62552414,630.59152218 1133.86660025,630.59152218 C1131.10767636,630.59152218 1128.86660025,628.35044607 1128.86660025,625.59152218 C1128.86660025,622.83259829 1131.10767636,620.59152218 1133.86660025,620.59152218 L1133.86660025,620.59152218 M1161.13932752,625.13697672 C1163.89825141,625.13697672 1166.13932752,627.37805284 1166.13932752,630.13697672 C1166.13932752,632.89590061 1163.89825141,635.13697672 1161.13932752,635.13697672 C1158.38040363,635.13697672 1156.13932752,632.89590061 1156.13932752,630.13697672 C1156.13932752,627.37805284 1158.38040363,625.13697672 1161.13932752,625.13697672 L1161.13932752,625.13697672 M1188.4120548,629.68243127 C1191.17097868,629.68243127 1193.4120548,631.92350738 1193.4120548,634.68243127 C1193.4120548,637.4413551600001 1191.17097868,639.68243127 1188.4120548,639.68243127 C1185.65313091,639.68243127 1183.4120548,637.4413551600001 1183.4120548,634.68243127 C1183.4120548,631.92350738 1185.65313091,629.68243127 1188.4120548,629.68243127 L1188.4120548,629.68243127 M1215.68478207,634.22788582 C1218.44370596,634.22788582 1220.68478207,636.46896193 1220.68478207,639.22788582 C1220.68478207,641.9868097 1218.44370596,644.22788582 1215.68478207,644.22788582 C1212.92585818,644.22788582 1210.68478207,641.9868097 1210.68478207,639.22788582 C1210.68478207,636.46896193 1212.92585818,634.22788582 1215.68478207,634.22788582 L1215.68478207,634.22788582 M1242.9575093400001,638.77334036 C1245.7164332300001,638.77334036 1247.9575093400001,641.01441647 1247.9575093400001,643.77334036 C1247.9575093400001,646.53226425 1245.7164332300001,648.77334036 1242.9575093400001,648.77334036 C1240.19858545,648.77334036 1237.9575093400001,646.53226425 1237.9575093400001,643.77334036 C1237.9575093400001,641.01441647 1240.19858545,638.77334036 1242.9575093400001,638.77334036 L1242.9575093400001,638.77334036 M1270.23023661,643.3187949100001 C1272.9891605,643.3187949100001 1275.23023661,645.5598710200001 1275.23023661,648.3187949100001 C1275.23023661,651.0777188 1272.9891605,653.3187949100001 1270.23023661,653.3187949100001 C1267.4713127300001,653.3187949100001 1265.23023661,651.0777188 1265.23023661,648.3187949100001 C1265.23023661,645.5598710200001 1267.4713127300001,643.3187949100001 1270.23023661,643.3187949100001 L1270.23023661,643.3187949100001 M1297.50296389,647.86424945 C1300.26188778,647.86424945 1302.50296389,650.10532556 1302.50296389,652.86424945 C1302.50296389,655.62317334 1300.26188778,657.86424945 1297.50296389,657.86424945 C1294.74404,657.86424945 1292.50296389,655.62317334 1292.50296389,652.86424945 C1292.50296389,650.10532556 1294.74404,647.86424945 1297.50296389,647.86424945 L1297.50296389,647.86424945 M997.50296389,626.4356780200001 C1000.26188778,626.4356780200001 1002.50296389,628.6767541300001 1002.50296389,631.4356780200001 C1002.50296389,634.19460191 1000.26188778,636.4356780200001 997.50296389,636.4356780200001 C994.74404,636.4356780200001 992.50296389,634.19460191 992.50296389,631.4356780200001 C992.50296389,628.6767541300001 994.74404,626.4356780200001 997.50296389,626.4356780200001 L997.50296389,626.4356780200001 M1024.77569116,630.98113257 C1027.53461505,630.98113257 1029.77569116,633.22220868 1029.77569116,635.98113257 C1029.77569116,638.74005646 1027.53461505,640.98113257 1024.77569116,640.98113257 C1022.0167672700001,640.98113257 1019.7756911600001,638.74005646 1019.7756911600001,635.98113257 C1019.7756911600001,633.22220868 1022.0167672700001,630.98113257 1024.77569116,630.98113257 L1024.77569116,630.98113257 M1052.04841843,635.52658711 C1054.80734232,635.52658711 1057.04841843,637.76766323 1057.04841843,640.52658711 C1057.04841843,643.285511 1054.80734232,645.52658711 1052.04841843,645.52658711 C1049.28949454,645.52658711 1047.04841843,643.285511 1047.04841843,640.52658711 C1047.04841843,637.76766323 1049.28949454,635.52658711 1052.04841843,635.52658711 L1052.04841843,635.52658711 M1079.32114571,640.07204166 C1082.08006959,640.07204166 1084.32114571,642.31311777 1084.32114571,645.07204166 C1084.32114571,647.83096555 1082.08006959,650.07204166 1079.32114571,650.07204166 C1076.56222182,650.07204166 1074.32114571,647.83096555 1074.32114571,645.07204166 C1074.32114571,642.31311777 1076.56222182,640.07204166 1079.32114571,640.07204166 L1079.32114571,640.07204166 M1106.59387298,644.61749621 C1109.35279687,644.61749621 1111.59387298,646.85857232 1111.59387298,649.61749621 C1111.59387298,652.37642009 1109.35279687,654.61749621 1106.59387298,654.61749621 C1103.83494909,654.61749621 1101.59387298,652.37642009 1101.59387298,649.61749621 C1101.59387298,646.85857232 1103.83494909,644.61749621 1106.59387298,644.61749621 L1106.59387298,644.61749621 M1133.86660025,649.16295075 C1136.62552414,649.16295075 1138.86660025,651.40402686 1138.86660025,654.16295075 C1138.86660025,656.92187464 1136.62552414,659.16295075 1133.86660025,659.16295075 C1131.10767636,659.16295075 1128.86660025,656.92187464 1128.86660025,654.16295075 C1128.86660025,651.40402686 1131.10767636,649.16295075 1133.86660025,649.16295075 L1133.86660025,649.16295075 M1161.13932752,653.7084053 C1163.89825141,653.7084053 1166.13932752,655.94948141 1166.13932752,658.7084053 C1166.13932752,661.46732918 1163.89825141,663.7084053 1161.13932752,663.7084053 C1158.38040363,663.7084053 1156.13932752,661.46732918 1156.13932752,658.7084053 C1156.13932752,655.94948141 1158.38040363,653.7084053 1161.13932752,653.7084053 L1161.13932752,653.7084053 M1188.4120548,658.25385984 C1191.17097868,658.25385984 1193.4120548,660.49493595 1193.4120548,663.25385984 C1193.4120548,666.01278373 1191.17097868,668.25385984 1188.4120548,668.25385984 C1185.65313091,668.25385984 1183.4120548,666.01278373 1183.4120548,663.25385984 C1183.4120548,660.49493595 1185.65313091,658.25385984 1188.4120548,658.25385984 L1188.4120548,658.25385984 M1215.68478207,662.7993143900001 C1218.44370596,662.7993143900001 1220.68478207,665.0403905000001 1220.68478207,667.7993143900001 C1220.68478207,670.5582382800001 1218.44370596,672.7993143900001 1215.68478207,672.7993143900001 C1212.92585818,672.7993143900001 1210.68478207,670.5582382800001 1210.68478207,667.7993143900001 C1210.68478207,665.0403905000001 1212.92585818,662.7993143900001 1215.68478207,662.7993143900001 L1215.68478207,662.7993143900001 M1242.9575093400001,667.34476893 C1245.7164332300001,667.34476893 1247.9575093400001,669.58584504 1247.9575093400001,672.34476893 C1247.9575093400001,675.10369282 1245.7164332300001,677.34476893 1242.9575093400001,677.34476893 C1240.19858545,677.34476893 1237.9575093400001,675.10369282 1237.9575093400001,672.34476893 C1237.9575093400001,669.58584504 1240.19858545,667.34476893 1242.9575093400001,667.34476893 L1242.9575093400001,667.34476893 M1270.23023661,671.89022348 C1272.9891605,671.89022348 1275.23023661,674.13129959 1275.23023661,676.89022348 C1275.23023661,679.64914737 1272.9891605,681.89022348 1270.23023661,681.89022348 C1267.4713127300001,681.89022348 1265.23023661,679.64914737 1265.23023661,676.89022348 C1265.23023661,674.13129959 1267.4713127300001,671.89022348 1270.23023661,671.89022348 L1270.23023661,671.89022348 M1297.50296389,676.4356780200001 C1300.26188778,676.4356780200001 1302.50296389,678.6767541300001 1302.50296389,681.4356780200001 C1302.50296389,684.19460191 1300.26188778,686.4356780200001 1297.50296389,686.4356780200001 C1294.74404,686.4356780200001 1292.50296389,684.19460191 1292.50296389,681.4356780200001 C1292.50296389,678.6767541300001 1294.74404,676.4356780200001 1297.50296389,676.4356780200001 L1297.50296389,676.4356780200001 M997.50296389,655.00710659 C1000.26188778,655.00710659 1002.50296389,657.24818271 1002.50296389,660.00710659 C1002.50296389,662.76603048 1000.26188778,665.00710659 997.50296389,665.00710659 C994.74404,665.00710659 992.50296389,662.76603048 992.50296389,660.00710659 C992.50296389,657.24818271 994.74404,655.00710659 997.50296389,655.00710659 L997.50296389,655.00710659 M1024.77569116,659.55256114 C1027.53461505,659.55256114 1029.77569116,661.79363725 1029.77569116,664.55256114 C1029.77569116,667.31148503 1027.53461505,669.55256114 1024.77569116,669.55256114 C1022.0167672700001,669.55256114 1019.7756911600001,667.31148503 1019.7756911600001,664.55256114 C1019.7756911600001,661.79363725 1022.0167672700001,659.55256114 1024.77569116,659.55256114 L1024.77569116,659.55256114 M1052.04841843,664.09801569 C1054.80734232,664.09801569 1057.04841843,666.3390918 1057.04841843,669.09801569 C1057.04841843,671.85693957 1054.80734232,674.09801569 1052.04841843,674.09801569 C1049.28949454,674.09801569 1047.04841843,671.85693957 1047.04841843,669.09801569 C1047.04841843,666.3390918 1049.28949454,664.09801569 1052.04841843,664.09801569 L1052.04841843,664.09801569 M1079.32114571,668.64347023 C1082.08006959,668.64347023 1084.32114571,670.88454634 1084.32114571,673.64347023 C1084.32114571,676.40239412 1082.08006959,678.64347023 1079.32114571,678.64347023 C1076.56222182,678.64347023 1074.32114571,676.40239412 1074.32114571,673.64347023 C1074.32114571,670.88454634 1076.56222182,668.64347023 1079.32114571,668.64347023 L1079.32114571,668.64347023 M1106.59387298,673.18892478 C1109.35279687,673.18892478 1111.59387298,675.43000089 1111.59387298,678.18892478 C1111.59387298,680.94784867 1109.35279687,683.18892478 1106.59387298,683.18892478 C1103.83494909,683.18892478 1101.59387298,680.94784867 1101.59387298,678.18892478 C1101.59387298,675.43000089 1103.83494909,673.18892478 1106.59387298,673.18892478 L1106.59387298,673.18892478 M1133.86660025,677.73437932 C1136.62552414,677.73437932 1138.86660025,679.97545543 1138.86660025,682.73437932 C1138.86660025,685.49330321 1136.62552414,687.73437932 1133.86660025,687.73437932 C1131.10767636,687.73437932 1128.86660025,685.49330321 1128.86660025,682.73437932 C1128.86660025,679.97545543 1131.10767636,677.73437932 1133.86660025,677.73437932 L1133.86660025,677.73437932 M1161.13932752,682.2798338700001 C1163.89825141,682.2798338700001 1166.13932752,684.52090998 1166.13932752,687.2798338700001 C1166.13932752,690.0387577600001 1163.89825141,692.2798338700001 1161.13932752,692.2798338700001 C1158.38040363,692.2798338700001 1156.13932752,690.0387577600001 1156.13932752,687.2798338700001 C1156.13932752,684.52090998 1158.38040363,682.2798338700001 1161.13932752,682.2798338700001 L1161.13932752,682.2798338700001 M1188.4120548,686.82528841 C1191.17097868,686.82528841 1193.4120548,689.06636452 1193.4120548,691.82528841 C1193.4120548,694.5842123 1191.17097868,696.82528841 1188.4120548,696.82528841 C1185.65313091,696.82528841 1183.4120548,694.5842123 1183.4120548,691.82528841 C1183.4120548,689.06636452 1185.65313091,686.82528841 1188.4120548,686.82528841 L1188.4120548,686.82528841 M1215.68478207,691.37074296 C1218.44370596,691.37074296 1220.68478207,693.61181907 1220.68478207,696.37074296 C1220.68478207,699.12966685 1218.44370596,701.37074296 1215.68478207,701.37074296 C1212.92585818,701.37074296 1210.68478207,699.12966685 1210.68478207,696.37074296 C1210.68478207,693.61181907 1212.92585818,691.37074296 1215.68478207,691.37074296 L1215.68478207,691.37074296 M1242.9575093400001,695.9161975000001 C1245.7164332300001,695.9161975000001 1247.9575093400001,698.1572736100001 1247.9575093400001,700.9161975000001 C1247.9575093400001,703.67512139 1245.7164332300001,705.9161975000001 1242.9575093400001,705.9161975000001 C1240.19858545,705.9161975000001 1237.9575093400001,703.67512139 1237.9575093400001,700.9161975000001 C1237.9575093400001,698.1572736100001 1240.19858545,695.9161975000001 1242.9575093400001,695.9161975000001 L1242.9575093400001,695.9161975000001 M1270.23023661,700.46165205 C1272.9891605,700.46165205 1275.23023661,702.70272816 1275.23023661,705.46165205 C1275.23023661,708.22057594 1272.9891605,710.46165205 1270.23023661,710.46165205 C1267.4713127300001,710.46165205 1265.23023661,708.22057594 1265.23023661,705.46165205 C1265.23023661,702.70272816 1267.4713127300001,700.46165205 1270.23023661,700.46165205 L1270.23023661,700.46165205 M1297.50296389,705.00710659 C1300.26188778,705.00710659 1302.50296389,707.24818271 1302.50296389,710.00710659 C1302.50296389,712.76603048 1300.26188778,715.00710659 1297.50296389,715.00710659 C1294.74404,715.00710659 1292.50296389,712.76603048 1292.50296389,710.00710659 C1292.50296389,707.24818271 1294.74404,705.00710659 1297.50296389,705.00710659 L1297.50296389,705.00710659 M997.50296389,683.57853517 C1000.26188778,683.57853517 1002.50296389,685.81961128 1002.50296389,688.57853517 C1002.50296389,691.33745906 1000.26188778,693.57853517 997.50296389,693.57853517 C994.74404,693.57853517 992.50296389,691.33745906 992.50296389,688.57853517 C992.50296389,685.81961128 994.74404,683.57853517 997.50296389,683.57853517 L997.50296389,683.57853517 M1024.77569116,688.12398971 C1027.53461505,688.12398971 1029.77569116,690.36506582 1029.77569116,693.12398971 C1029.77569116,695.8829136 1027.53461505,698.12398971 1024.77569116,698.12398971 C1022.0167672700001,698.12398971 1019.7756911600001,695.8829136 1019.7756911600001,693.12398971 C1019.7756911600001,690.36506582 1022.0167672700001,688.12398971 1024.77569116,688.12398971 L1024.77569116,688.12398971 M1052.04841843,692.66944426 C1054.80734232,692.66944426 1057.04841843,694.91052037 1057.04841843,697.66944426 C1057.04841843,700.42836815 1054.80734232,702.66944426 1052.04841843,702.66944426 C1049.28949454,702.66944426 1047.04841843,700.42836815 1047.04841843,697.66944426 C1047.04841843,694.91052037 1049.28949454,692.66944426 1052.04841843,692.66944426 L1052.04841843,692.66944426 M1079.32114571,697.2148988 C1082.08006959,697.2148988 1084.32114571,699.45597491 1084.32114571,702.2148988 C1084.32114571,704.97382269 1082.08006959,707.2148988 1079.32114571,707.2148988 C1076.56222182,707.2148988 1074.32114571,704.97382269 1074.32114571,702.2148988 C1074.32114571,699.45597491 1076.56222182,697.2148988 1079.32114571,697.2148988 L1079.32114571,697.2148988 M1106.59387298,701.7603533500001 C1109.35279687,701.7603533500001 1111.59387298,704.00142946 1111.59387298,706.7603533500001 C1111.59387298,709.5192772400001 1109.35279687,711.7603533500001 1106.59387298,711.7603533500001 C1103.83494909,711.7603533500001 1101.59387298,709.5192772400001 1101.59387298,706.7603533500001 C1101.59387298,704.00142946 1103.83494909,701.7603533500001 1106.59387298,701.7603533500001 L1106.59387298,701.7603533500001 M1133.86660025,706.30580789 C1136.62552414,706.30580789 1138.86660025,708.546884 1138.86660025,711.30580789 C1138.86660025,714.06473178 1136.62552414,716.30580789 1133.86660025,716.30580789 C1131.10767636,716.30580789 1128.86660025,714.06473178 1128.86660025,711.30580789 C1128.86660025,708.546884 1131.10767636,706.30580789 1133.86660025,706.30580789 L1133.86660025,706.30580789 M1161.13932752,710.85126244 C1163.89825141,710.85126244 1166.13932752,713.09233855 1166.13932752,715.85126244 C1166.13932752,718.61018633 1163.89825141,720.85126244 1161.13932752,720.85126244 C1158.38040363,720.85126244 1156.13932752,718.61018633 1156.13932752,715.85126244 C1156.13932752,713.09233855 1158.38040363,710.85126244 1161.13932752,710.85126244 L1161.13932752,710.85126244 M1188.4120548,715.3967169800001 C1191.17097868,715.3967169800001 1193.4120548,717.6377931000001 1193.4120548,720.3967169800001 C1193.4120548,723.1556408700001 1191.17097868,725.3967169800001 1188.4120548,725.3967169800001 C1185.65313091,725.3967169800001 1183.4120548,723.1556408700001 1183.4120548,720.3967169800001 C1183.4120548,717.6377931000001 1185.65313091,715.3967169800001 1188.4120548,715.3967169800001 L1188.4120548,715.3967169800001 M1215.68478207,719.94217153 C1218.44370596,719.94217153 1220.68478207,722.18324764 1220.68478207,724.94217153 C1220.68478207,727.70109542 1218.44370596,729.94217153 1215.68478207,729.94217153 C1212.92585818,729.94217153 1210.68478207,727.70109542 1210.68478207,724.94217153 C1210.68478207,722.18324764 1212.92585818,719.94217153 1215.68478207,719.94217153 L1215.68478207,719.94217153 M1242.9575093400001,724.48762608 C1245.7164332300001,724.48762608 1247.9575093400001,726.72870219 1247.9575093400001,729.48762608 C1247.9575093400001,732.24654996 1245.7164332300001,734.48762608 1242.9575093400001,734.48762608 C1240.19858545,734.48762608 1237.9575093400001,732.24654996 1237.9575093400001,729.48762608 C1237.9575093400001,726.72870219 1240.19858545,724.48762608 1242.9575093400001,724.48762608 L1242.9575093400001,724.48762608 M1270.23023661,729.03308062 C1272.9891605,729.03308062 1275.23023661,731.27415673 1275.23023661,734.03308062 C1275.23023661,736.79200451 1272.9891605,739.03308062 1270.23023661,739.03308062 C1267.4713127300001,739.03308062 1265.23023661,736.79200451 1265.23023661,734.03308062 C1265.23023661,731.27415673 1267.4713127300001,729.03308062 1270.23023661,729.03308062 L1270.23023661,729.03308062 M1297.50296389,733.57853517 C1300.26188778,733.57853517 1302.50296389,735.81961128 1302.50296389,738.57853517 C1302.50296389,741.33745906 1300.26188778,743.57853517 1297.50296389,743.57853517 C1294.74404,743.57853517 1292.50296389,741.33745906 1292.50296389,738.57853517 C1292.50296389,735.81961128 1294.74404,733.57853517 1297.50296389,733.57853517 L1297.50296389,733.57853517 M997.50296389,712.14996374 C1000.26188778,712.14996374 1002.50296389,714.39103985 1002.50296389,717.14996374 C1002.50296389,719.90888763 1000.26188778,722.14996374 997.50296389,722.14996374 C994.74404,722.14996374 992.50296389,719.90888763 992.50296389,717.14996374 C992.50296389,714.39103985 994.74404,712.14996374 997.50296389,712.14996374 L997.50296389,712.14996374 M1024.77569116,716.69541828 C1027.53461505,716.69541828 1029.77569116,718.93649439 1029.77569116,721.69541828 C1029.77569116,724.45434217 1027.53461505,726.69541828 1024.77569116,726.69541828 C1022.0167672700001,726.69541828 1019.7756911600001,724.45434217 1019.7756911600001,721.69541828 C1019.7756911600001,718.93649439 1022.0167672700001,716.69541828 1024.77569116,716.69541828 L1024.77569116,716.69541828 M1052.04841843,721.2408728300001 C1054.80734232,721.2408728300001 1057.04841843,723.48194894 1057.04841843,726.2408728300001 C1057.04841843,728.9997967200001 1054.80734232,731.2408728300001 1052.04841843,731.2408728300001 C1049.28949454,731.2408728300001 1047.04841843,728.9997967200001 1047.04841843,726.2408728300001 C1047.04841843,723.48194894 1049.28949454,721.2408728300001 1052.04841843,721.2408728300001 L1052.04841843,721.2408728300001 M1079.32114571,725.78632737 C1082.08006959,725.78632737 1084.32114571,728.02740349 1084.32114571,730.78632737 C1084.32114571,733.54525126 1082.08006959,735.78632737 1079.32114571,735.78632737 C1076.56222182,735.78632737 1074.32114571,733.54525126 1074.32114571,730.78632737 C1074.32114571,728.02740349 1076.56222182,725.78632737 1079.32114571,725.78632737 L1079.32114571,725.78632737 M1106.59387298,730.33178192 C1109.35279687,730.33178192 1111.59387298,732.57285803 1111.59387298,735.33178192 C1111.59387298,738.09070581 1109.35279687,740.33178192 1106.59387298,740.33178192 C1103.83494909,740.33178192 1101.59387298,738.09070581 1101.59387298,735.33178192 C1101.59387298,732.57285803 1103.83494909,730.33178192 1106.59387298,730.33178192 L1106.59387298,730.33178192 M1133.86660025,734.8772364600001 C1136.62552414,734.8772364600001 1138.86660025,737.1183125800001 1138.86660025,739.8772364600001 C1138.86660025,742.6361603500001 1136.62552414,744.8772364600001 1133.86660025,744.8772364600001 C1131.10767636,744.8772364600001 1128.86660025,742.6361603500001 1128.86660025,739.8772364600001 C1128.86660025,737.1183125800001 1131.10767636,734.8772364600001 1133.86660025,734.8772364600001 L1133.86660025,734.8772364600001 M1161.13932752,739.42269101 C1163.89825141,739.42269101 1166.13932752,741.66376712 1166.13932752,744.42269101 C1166.13932752,747.1816149 1163.89825141,749.42269101 1161.13932752,749.42269101 C1158.38040363,749.42269101 1156.13932752,747.1816149 1156.13932752,744.42269101 C1156.13932752,741.66376712 1158.38040363,739.42269101 1161.13932752,739.42269101 L1161.13932752,739.42269101 M1188.4120548,743.96814556 C1191.17097868,743.96814556 1193.4120548,746.20922167 1193.4120548,748.96814556 C1193.4120548,751.72706944 1191.17097868,753.96814556 1188.4120548,753.96814556 C1185.65313091,753.96814556 1183.4120548,751.72706944 1183.4120548,748.96814556 C1183.4120548,746.20922167 1185.65313091,743.96814556 1188.4120548,743.96814556 L1188.4120548,743.96814556 M1215.68478207,748.5136001 C1218.44370596,748.5136001 1220.68478207,750.7546762100001 1220.68478207,753.5136001 C1220.68478207,756.27252399 1218.44370596,758.5136001 1215.68478207,758.5136001 C1212.92585818,758.5136001 1210.68478207,756.27252399 1210.68478207,753.5136001 C1210.68478207,750.7546762100001 1212.92585818,748.5136001 1215.68478207,748.5136001 L1215.68478207,748.5136001 M1242.9575093400001,753.05905465 C1245.7164332300001,753.05905465 1247.9575093400001,755.30013076 1247.9575093400001,758.05905465 C1247.9575093400001,760.81797854 1245.7164332300001,763.05905465 1242.9575093400001,763.05905465 C1240.19858545,763.05905465 1237.9575093400001,760.81797854 1237.9575093400001,758.05905465 C1237.9575093400001,755.30013076 1240.19858545,753.05905465 1242.9575093400001,753.05905465 L1242.9575093400001,753.05905465 M1270.23023661,757.60450919 C1272.9891605,757.60450919 1275.23023661,759.8455853 1275.23023661,762.60450919 C1275.23023661,765.36343308 1272.9891605,767.60450919 1270.23023661,767.60450919 C1267.4713127300001,767.60450919 1265.23023661,765.36343308 1265.23023661,762.60450919 C1265.23023661,759.8455853 1267.4713127300001,757.60450919 1270.23023661,757.60450919 L1270.23023661,757.60450919 M1297.50296389,762.14996374 C1300.26188778,762.14996374 1302.50296389,764.39103985 1302.50296389,767.14996374 C1302.50296389,769.90888763 1300.26188778,772.14996374 1297.50296389,772.14996374 C1294.74404,772.14996374 1292.50296389,769.90888763 1292.50296389,767.14996374 C1292.50296389,764.39103985 1294.74404,762.14996374 1297.50296389,762.14996374 L1297.50296389,762.14996374 M997.50296389,740.72139231 C1000.26188778,740.72139231 1002.50296389,742.96246842 1002.50296389,745.72139231 C1002.50296389,748.4803162000001 1000.26188778,750.72139231 997.50296389,750.72139231 C994.74404,750.72139231 992.50296389,748.4803162000001 992.50296389,745.72139231 C992.50296389,742.96246842 994.74404,740.72139231 997.50296389,740.72139231 L997.50296389,740.72139231 M1024.77569116,745.26684685 C1027.53461505,745.26684685 1029.77569116,747.50792297 1029.77569116,750.26684685 C1029.77569116,753.02577074 1027.53461505,755.26684685 1024.77569116,755.26684685 C1022.0167672700001,755.26684685 1019.7756911600001,753.02577074 1019.7756911600001,750.26684685 C1019.7756911600001,747.50792297 1022.0167672700001,745.26684685 1024.77569116,745.26684685 L1024.77569116,745.26684685 M1052.04841843,749.8123014 C1054.80734232,749.8123014 1057.04841843,752.05337751 1057.04841843,754.8123014 C1057.04841843,757.57122529 1054.80734232,759.8123014 1052.04841843,759.8123014 C1049.28949454,759.8123014 1047.04841843,757.57122529 1047.04841843,754.8123014 C1047.04841843,752.05337751 1049.28949454,749.8123014 1052.04841843,749.8123014 L1052.04841843,749.8123014 M1079.32114571,754.3577559500001 C1082.08006959,754.3577559500001 1084.32114571,756.5988320600001 1084.32114571,759.3577559500001 C1084.32114571,762.1166798300001 1082.08006959,764.3577559500001 1079.32114571,764.3577559500001 C1076.56222182,764.3577559500001 1074.32114571,762.1166798300001 1074.32114571,759.3577559500001 C1074.32114571,756.5988320600001 1076.56222182,754.3577559500001 1079.32114571,754.3577559500001 L1079.32114571,754.3577559500001 M1106.59387298,758.90321049 C1109.35279687,758.90321049 1111.59387298,761.1442866 1111.59387298,763.90321049 C1111.59387298,766.66213438 1109.35279687,768.90321049 1106.59387298,768.90321049 C1103.83494909,768.90321049 1101.59387298,766.66213438 1101.59387298,763.90321049 C1101.59387298,761.1442866 1103.83494909,758.90321049 1106.59387298,758.90321049 L1106.59387298,758.90321049 M1133.86660025,763.44866504 C1136.62552414,763.44866504 1138.86660025,765.68974115 1138.86660025,768.44866504 C1138.86660025,771.20758893 1136.62552414,773.44866504 1133.86660025,773.44866504 C1131.10767636,773.44866504 1128.86660025,771.20758893 1128.86660025,768.44866504 C1128.86660025,765.68974115 1131.10767636,763.44866504 1133.86660025,763.44866504 L1133.86660025,763.44866504 M1161.13932752,767.99411958 C1163.89825141,767.99411958 1166.13932752,770.2351956900001 1166.13932752,772.99411958 C1166.13932752,775.75304347 1163.89825141,777.99411958 1161.13932752,777.99411958 C1158.38040363,777.99411958 1156.13932752,775.75304347 1156.13932752,772.99411958 C1156.13932752,770.2351956900001 1158.38040363,767.99411958 1161.13932752,767.99411958 L1161.13932752,767.99411958 M1188.4120548,772.53957413 C1191.17097868,772.53957413 1193.4120548,774.78065024 1193.4120548,777.53957413 C1193.4120548,780.29849802 1191.17097868,782.53957413 1188.4120548,782.53957413 C1185.65313091,782.53957413 1183.4120548,780.29849802 1183.4120548,777.53957413 C1183.4120548,774.78065024 1185.65313091,772.53957413 1188.4120548,772.53957413 L1188.4120548,772.53957413 M1215.68478207,777.08502867 C1218.44370596,777.08502867 1220.68478207,779.32610478 1220.68478207,782.08502867 C1220.68478207,784.84395256 1218.44370596,787.08502867 1215.68478207,787.08502867 C1212.92585818,787.08502867 1210.68478207,784.84395256 1210.68478207,782.08502867 C1210.68478207,779.32610478 1212.92585818,777.08502867 1215.68478207,777.08502867 L1215.68478207,777.08502867 M1242.9575093400001,781.63048322 C1245.7164332300001,781.63048322 1247.9575093400001,783.87155933 1247.9575093400001,786.63048322 C1247.9575093400001,789.38940711 1245.7164332300001,791.63048322 1242.9575093400001,791.63048322 C1240.19858545,791.63048322 1237.9575093400001,789.38940711 1237.9575093400001,786.63048322 C1237.9575093400001,783.87155933 1240.19858545,781.63048322 1242.9575093400001,781.63048322 L1242.9575093400001,781.63048322 M1270.23023661,786.17593776 C1272.9891605,786.17593776 1275.23023661,788.41701387 1275.23023661,791.17593776 C1275.23023661,793.93486165 1272.9891605,796.17593776 1270.23023661,796.17593776 C1267.4713127300001,796.17593776 1265.23023661,793.93486165 1265.23023661,791.17593776 C1265.23023661,788.41701387 1267.4713127300001,786.17593776 1270.23023661,786.17593776 L1270.23023661,786.17593776 M1297.50296389,790.72139231 C1300.26188778,790.72139231 1302.50296389,792.96246842 1302.50296389,795.72139231 C1302.50296389,798.4803162000001 1300.26188778,800.72139231 1297.50296389,800.72139231 C1294.74404,800.72139231 1292.50296389,798.4803162000001 1292.50296389,795.72139231 C1292.50296389,792.96246842 1294.74404,790.72139231 1297.50296389,790.72139231 L1297.50296389,790.72139231").unwrap();
        binary_op(&p1, &p2, FillRule::EvenOdd, BinaryOp::Union).unwrap();
    }
}
